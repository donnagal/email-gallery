<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>Email Report Dashboard</title>
	<link href="../../images/favion.png" rel="icon" type="image/x-icon" />

	<link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@700&display=swap" rel="stylesheet">
	<link rel='stylesheet' href='../../css/v-dashbaord.css'>
	<link rel='stylesheet' href='https://kit-pro.fontawesome.com/releases/v5.13.1/css/pro.min.css'>
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/0.7.4/tailwind.min.css'>
	<link rel="stylesheet" href="../../css/global.css">
	<link rel="stylesheet" href="../../css/swiper-bundle.min.css">

<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

	<style>
		.card-template,
		.card-inspo {
			display: none;
		}

		.active {
			font-weight: bold;
			color: black;
		}

		.rotate {
			-webkit-transform: rotate(180deg);
			-moz-transform: rotate(180deg);
			-o-transform: rotate(180deg);
			-ms-transform: rotate(180deg);
			transform: rotate(180deg);
		}

		.hover:hover {
			opacity: .7;
			transition: opacity 0.2s ease-in;
		}

		.px-lg-md {
			padding-left: 8rem;
			padding-right: 8rem;
		}

		.h-lg-md {
			height: 40rem;
		}

		/* md */
		@media (max-width: 1600px) {
			.px-lg-md {
				padding-left: 3rem;
				padding-right: 4rem;
			}

			.h-lg-md {
				height: 23rem;
			}
		}

		.ecol-lg {
			width: 15%;
		}

		.ecol-md {
			width: 7%;
		}

		.ecol {
			width: 5%;
		}
		.t-stlyes   table {
    border-collapse: collapse;
    width: 100%;
    background: white;
    box-shadow: 0 0 8px rgba(0,0,0,0.05);
    border-radius: 5px;
    overflow: hidden;
  }
  thead {
    background-color: #2c7be5;
    color: white;
	font-size: 12px;
  }
  th, td {
    padding: 10px 14px;
    border-bottom: 1px solid #eaeaea;
    text-align: left;
    user-select: none;
  }
  th {
    cursor: pointer;
    position: relative;
    font-weight: 600;
    white-space: nowrap;
  }
  th.sort-asc::after,
  th.sort-desc::after {
    content: '';
    position: absolute;
    right: 8px;
    top: 50%;
    width: 0; 
    height: 0; 
    border-style: solid;
    transform: translateY(-50%);
  }
  th.sort-asc::after {
    border-width: 6px 5px 0 5px;
    border-color: #fff transparent transparent transparent;
  }
  th.sort-desc::after {
    border-width: 0 5px 6px 5px;
    border-color: transparent transparent #fff transparent;
  }
  tbody tr:hover {
    background: #f1f8ff;
  }
  tfoot td {
    font-weight: 700;
    background: #f0f0f0;
    font-size: 15px;
  }
	</style>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-LF495ZKW9K"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());

		gtag('config', 'G-LF495ZKW9K');
	</script>
</head>

<body class="bg-gray-200 ">

  <div id="nav">
    <header>
      <div class="bg-black mx-auto text-white px-5 text-center">
        <div class="flex py-2">
          <div class="flex-1">
            <h1 class="font-bold text-2xl flex gap-6 items-center justify-center">

              <svg class="w-5 h-5" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M2 10C2 5.58172 5.58172 2 10 2V10H18C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10Z"
                  fill="currentColor"></path>
                <path d="M12 2.25195C14.8113 2.97552 17.0245 5.18877 17.748 8.00004H12V2.25195Z"
                  fill="currentColor"></path>
              </svg>

              <div>Dashboard</div>
            </h1>
          </div>
        </div>
      </div>
    </header>
    <nav class="animate-add z-100">
      <div class="nav-overlay"></div>
      <button type="button" class="slide-toggle">
        <div class="menu-wrapper">
          <div class="hamburger-menu"></div>
        </div>
      </button>
      <div id="menu">
        <!-- <img src="images/duck.gif" /> -->
      </div>
    </nav>
  </div>

  <div class="" data-v-app="" id="app">
    <div class="flex bg-gray-200 font-roboto">

      <div class="flex-1 flex flex-col ">
        <main class="flex-1">
          <div class="px-lg-md md:container mx-auto py-8">
            <div>

              <input class="w-full border-2 border-gray-300 bg-white h-10 px-5 pr-16 rounded-lg text-sm focus:outline-none"
                type="search"
                placeholder="Search Campaign Name..."
                v-model="searchTerm"
                aria-label="Search campaigns"
              />
              <div class="flex justify-end m-3">
                <a
                  href="data/ajo-report-fy25.xlsx"
                  download
                  class="px-4 py-2 bg-black text-white rounded hover:bg-blue-600 transition inline-block text-center"
                  aria-label="Download Excel report"
                >
                  Download
                </a>
              </div>
			  
 <div class="dashboard" v-if="lists.length">
    <p><strong>Avg Unique Opens %:</strong> {{ totals.openAvg }}%</p>
    <p><strong>Avg Unique Clicks %:</strong> {{ totals.clickAvg }}%</p>
    <p><strong>Total Delivered:</strong> {{ totals.delivered }}</p>
  </div>

              <table class="t-styles w-full mt-5 bg-white" v-if="filteredAndSorted.length">
                <thead>
                  <tr>
                    <th
                      @click="sortBy('label')"
                      :class="sortKey === 'label' ? ('sort-' + sortOrder) : ''"
                      scope="col"
                    >Campaign Name</th>
                    <th
                      @click="sortBy('day')"
                      :class="sortKey === 'day' ? ('sort-' + sortOrder) : ''"
                      scope="col"
                    >Send Date</th>
                    <th
                      @click="sortBy('brand')"
                      :class="sortKey === 'brand' ? ('sort-' + sortOrder) : ''"
                      scope="col"
                    >Brand</th>
                    <th
                      @click="sortBy('type')"
                      :class="sortKey === 'type' ? ('sort-' + sortOrder) : ''"
                      scope="col"
                    >Campaign Type</th>
                    <th
                      @click="sortBy('unique-opens-pc')"
                      :class="sortKey === 'unique-opens-pc' ? ('sort-' + sortOrder) : ''"
                      scope="col"
                    >Unique Opens %</th>
                    <th
                      @click="sortBy('unique-clicks-pc')"
                      :class="sortKey === 'unique-clicks-pc' ? ('sort-' + sortOrder) : ''"
                      scope="col"
                    >Unique Clicks %</th>
                    <th
                      @click="sortBy('delivered')"
                      :class="sortKey === 'delivered' ? ('sort-' + sortOrder) : ''"
                      scope="col"
                    >Delivered</th>
                    <th
                      @click="sortBy('unsub-pc')"
                      :class="sortKey === 'unsub-pc' ? ('sort-' + sortOrder) : ''"
                      scope="col"
                    >Unsub %</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="(item, index) in filteredAndSorted" :key="index">
                    <td>{{ item.label }}</td>
                    <td>{{ item.day }}</td>
                    <td>{{ item.brand }}</td>
                    <td>{{ item.type }}</td>
                    <td>{{ item['unique-opens-pc'].toFixed(2) }}%</td>
                    <td>{{ item['unique-clicks-pc'].toFixed(2) }}%</td>
                    <td>{{ item.delivered.toLocaleString() }}</td>
                    <td>{{ item['unsub-pc'].toFixed(2) }}%</td>
                  </tr>
                </tbody>
                <tfoot>
                  <tr>
                    <td colspan="4" class="text-right font-semibold">Totals / Averages:</td>
                    <td>{{ totals.openAvg }}%</td>
                    <td>{{ totals.clickAvg }}%</td>
                    <td>{{ totals.delivered }}</td>
                    <td>{{ totals.unsubAvg }}%</td>
                  </tr>
                </tfoot>
              </table>

              <p v-if="!lists.length" class="loading">Loading data, please wait...</p>
              <p v-if="lists.length && !filteredAndSorted.length" class="loading">No results found.</p>
            </div>

          </div>
        </main>
      </div>

    </div>
  </div>

  <script src="script.js"></script>
  <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
  <script src="../../js/filter-group.js"></script>
  <script src="../../js/global.js"></script>
  <script src="../../js/vue.min.js"></script>

</body>

</html>

