<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Email Report Dashboard</title>
    <link href="../../images/favion.png" rel="icon" type="image/x-icon" />
    <link
      href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../../css/v-dashbaord.css" />
    <link
      rel="stylesheet"
      href="https://kit-pro.fontawesome.com/releases/v5.13.1/css/pro.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/0.7.4/tailwind.min.css"
    />
    <link rel="stylesheet" href="../../css/global.css" />
    <link rel="stylesheet" href="../../css/swiper-bundle.min.css" />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  </head>

  <body class="bg-gray-200">
    <div id="nav">
      <header>
        <div class="bg-black mx-auto text-white px-5 text-center">
          <div class="flex py-2">
            <div class="flex-1">
              <h1 class="font-bold text-2xl">Email Dashboard FY26</h1>
            </div>
          </div>
        </div>
      </header>

      <nav class="animate-add z-100">
        <div class="nav-overlay"></div>
        <button type="button" class="slide-toggle">
          <div class="menu-wrapper">
            <div class="hamburger-menu"></div>
          </div>
        </button>
        <div id="menu"></div>
      </nav>
    </div>

    <div id="app">
      <div class="flex bg-gray-200 font-roboto">
        <div class="flex-1 flex flex-col">
          <main class="flex-1">
            <div class="px-lg-md md:container mx-auto py-8">
              <!-- Search input -->
              <input
                class="w-full border-2 border-gray-300 bg-white h-10 px-5 pr-16 rounded-lg text-sm focus:outline-none"
                type="search"
                placeholder="Search Campaign Name..."
                v-model="searchTerm"
              />

              <div class="flex justify-between m-3 gap-4">
                <a
                  href="../dashboard/last-fy/index.html"
                  class="flex items-center px-4 py-2 bg-black text-white rounded hover:bg-blue-600 transition text-center"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-4 h-4 mr-2"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15 19l-7-7 7-7"
                    />
                  </svg>
                  FY25
                </a>

                <a
                  href="data/email-report-fy26.xlsx"
                  download
                  class="px-4 py-2 bg-black text-white rounded hover:bg-blue-600 transition inline-block text-center"
                >
                  Download
                </a>
              </div>

              <!-- Table -->
              <table
                class="t-styles w-full mt-5 bg-white text-sm"
                v-if="filteredAndSorted.length"
              >
                <thead>
                  <tr>
                    <th>Preview</th>
                    <th @click="sortBy('label')" class="cursor-pointer">
                      Campaign Name {{ sortIndicator('label') }}
                    </th>
                    <th @click="sortBy('day')" class="cursor-pointer">
                      Send Date {{ sortIndicator('day') }}
                    </th>
                    <th @click="sortBy('brand')" class="cursor-pointer">
                      Brand {{ sortIndicator('brand') }}
                    </th>
                    <th @click="sortBy('type')" class="cursor-pointer">
                      Type {{ sortIndicator('type') }}
                    </th>
                    <th @click="sortBy('unique-sends')" class="cursor-pointer">
                      Unique Sends {{ sortIndicator('unique-sends') }}
                    </th>
                    <th @click="sortBy('unique-opens')" class="cursor-pointer">
                      Unique Opens {{ sortIndicator('unique-opens') }}
                    </th>
                    <th @click="sortBy('unique-clicks')" class="cursor-pointer">
                      Unique Clicks (CR) {{ sortIndicator('unique-clicks') }}
                    </th>
                    <th @click="sortBy('ctor-pc')" class="cursor-pointer">
                      CTOR {{ sortIndicator('ctor-pc') }}
                    </th>
                    <th @click="sortBy('unsub')" class="cursor-pointer">
                      Unsub {{ sortIndicator('unsub') }}
                    </th>
                    <th @click="sortBy('read-over-8s')" class="cursor-pointer">
                      Read &gt;8s {{ sortIndicator('read-over-8s') }}
                    </th>
                    <th @click="sortBy('read-under-8s')" class="cursor-pointer">
                      Read &lt;8s {{ sortIndicator('read-under-8s') }}
                    </th>
                    <th @click="sortBy('read-under-2s')" class="cursor-pointer">
                      Read &lt;2s {{ sortIndicator('read-under-2s') }}
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="(item, index) in filteredAndSorted" :key="index">
                    <!-- Preview -->
                    <td>
                      <a
                        :href="'../../pages/gallery/#' + item['img-id']"
                        target="_blank"
                        class="block rounded shadow bg-cover"
                        :style="{
                          backgroundImage: 'url(../../pages/gallery/images/' + item['img-id'] + '.jpg)',
                          height: '86px',
                          width: '86px',
                          backgroundPosition: 'top'
                        }"
                      >
                        <span class="sr-only">Preview of {{ item.label }}</span>
                      </a>
                    </td>

                    <!-- Text columns -->
                    <td>{{ item.label }}</td>
                    <td>{{ item.day }}</td>
                    <td>{{ item.brand }}</td>
                    <td>{{ item.type }}</td>
                    <td>{{ formatNumber(item['unique-sends']) }}</td>

                    <!-- Opens -->
                    <td>
                      <p class="text-lg">
                        {{ formatNumber(item['unique-opens']) }}
                      </p>
                      <p class="text-gray-500">
                        {{ formatPercentage(item['unique-opens-pc']) }}
                      </p>
                    </td>

                    <!-- Clicks -->
                    <td>
                      <p class="text-lg">
                        {{ formatNumber(item['unique-clicks']) }}
                      </p>
                      <p class="text-gray-500">
                        {{ formatPercentage(item['unique-clicks-pc']) }}
                      </p>
                    </td>

                    <!-- CTOR -->
                    <td>
                      <p class="text-lg">
                        {{ formatPercentage(item['ctor-pc']) }}
                      </p>
                    </td>

                    <!-- Unsub -->
                    <td>
                      <p class="text-lg">{{ formatNumber(item['unsub']) }}</p>
                      <p class="text-gray-500">
                        {{ formatPercentage(item['unsub-pc']) }}
                      </p>
                    </td>

                    <!-- Remaining columns -->
                    <td class="">{{ formatNumber(item['read-over-8s']) }}%</td>
                    <td class="">{{ formatNumber(item['read-under-8s']) }}%</td>
                    <td class="">{{ formatNumber(item['read-under-2s']) }}%</td>
                  </tr>
                </tbody>
                <tfoot>
                  <tr>
                    <td colspan="5" class="text-right font-semibold">
                      Totals / Averages:
                    </td>
                    <td>{{ formatNumber(totals.uniqueSends) }}</td>
                    <td>{{ formatPercentage(totals.openAvg) }}</td>
                    <td>{{ formatPercentage(totals.clickAvg) }}</td>
                    <td>{{ formatPercentage(totals.ctorAvg) }}</td>
                    <td>{{ formatPercentage(totals.unsubAvg) }}</td>
                    <td>{{ formatNumber(totals.readOver8s) }}</td>
                    <td>{{ formatNumber(totals.readUnder8s) }}</td>
                    <td>{{ formatNumber(totals.readUnder2s) }}</td>
                  </tr>
                </tfoot>
              </table>

              <p v-if="!lists.length" class="loading">
                Loading data, please wait...
              </p>
              <p
                v-if="lists.length && !filteredAndSorted.length"
                class="loading"
              >
                No results found.
              </p>
            </div>
          </main>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="../../../js/filter-group.js"></script>
    <script src="../../../js/global.js"></script>
    <script src="../../../js/vue.min.js"></script>
  </body>
</html>
